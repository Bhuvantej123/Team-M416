<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='indexStyle.css') }}">
</head>
<body>
    <div class="quiz-container">
        <h1>Quiz</h1>

        {% if quiz.questions %}
        <form id="quizForm">
            {% for q in quiz.questions %}
            <div class="question">
                <p><strong>{{ loop.index }}. {{ q.question }}</strong></p>
                <div class="options">
                    {% for opt in q.options %}
                    <label>
                        <input type="radio" name="q{{ loop.index }}" value="{{ opt[0] }}">
                        {{ opt }}
                    </label><br>
                    {% endfor %}
                </div>
                <input type="hidden" name="answer{{ loop.index }}" value="{{ q.answer }}">
            </div>
            {% endfor %}
            <button type="button" onclick="checkAnswers()">Submit Quiz</button>
        </form>
        <div id="result"></div>
        {% else %}
        <p>No quiz could be generated. Try uploading another PDF.</p>
        {% endif %}
    </div>

    <script>
function checkAnswers() {
    let total = parseInt("{{ quiz.questions|length or 0 }}");
    let score = 0;

    for (let i = 1; i <= total; i++) {
        let selected = document.querySelector('input[name="q' + i + '"]:checked');
        let correct = document.querySelector('input[name="answer' + i + '"]').value;

        if (selected && selected.value === correct) {
            score++;
        }
    }

    document.getElementById("result").innerText =
        "You scored " + score + " out of " + total;
}
</script>

</body>
</html>
